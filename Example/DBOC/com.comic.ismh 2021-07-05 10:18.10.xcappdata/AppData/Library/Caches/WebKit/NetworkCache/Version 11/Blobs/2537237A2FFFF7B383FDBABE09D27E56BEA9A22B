(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["PreemptiveTicketHome"],{"0a8b":function(t,e,i){},"1b5f":function(t,e,i){},3378:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"preemptiveTicketBox",staticClass:"preemptive-ticket"},[i("div",{staticClass:"main-box"},[i("div",{ref:"headerBox",class:{"header-box":!0,"header-fixed":t.isHeaderFixed}},[i("div",{staticClass:"back",on:{click:t.back}},[t.isHeaderFixed?[i("img",{attrs:{src:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/back-black.png",alt:""}})]:[i("img",{attrs:{src:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/back-white.png",alt:""}})]],2),i("div",{staticClass:"title"},[t._v("抢先券专区")]),i("div",{staticClass:"intro",on:{click:t.showIntroEvent}},[t._v("说明")])]),i("div",{staticClass:"banner-box"},[i("img",{staticClass:"banner-img",attrs:{src:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/banner.png",alt:""}}),i("marquee-list",{staticClass:"marquee-list",attrs:{dataList:t.marqueeData,lineHeight:50}})],1),i("div",{staticClass:"swiper-box"},[i("div",{staticClass:"comic-groups"},t._l(t.comicInfo.comicGroups,(function(e,s){return i("div",{key:s,class:{"group-item":!0,active:e.group_id===t.assetsInfo.groupId},on:{click:function(e){return t.toggleComicGroup(s)}}},[t._v(t._s(e.group_name))])})),0),i("div",{staticClass:"expire-time"},[t._v(t._s(t.comicInfo.activeGroupExpireTime))]),i("div",{staticClass:"swiper-container"},[i("div",{staticClass:"swiper-wrapper"},t._l(t.comicInfo.swiperComicList,(function(e,s){return i("div",{key:s,staticClass:"swiper-slide",attrs:{"data-cid":e.comic_id}},[i("img",{staticClass:"ticket-type",attrs:{src:t.mappingImgTicketType[e.star].swiperImg,alt:""}}),i("img",{staticClass:"comic-cover",attrs:{src:t.generateComicCover(e.comic_id),alt:""}}),i("div",{staticClass:"comic-name ellipsis"},[t._v(t._s(e.comic_name))])])})),0)]),i("div",{staticClass:"lottery-tips"},[t._v(t._s(t.assetsInfo.up_desc))])]),i("div",{staticClass:"btn-box"},[i("div",{staticClass:"common-btn"},[i("div",{staticClass:"signle-btn",on:{click:function(e){return t.lottery(!1)}}},[t.assetsInfo.single_draw_price.free_times?[i("div",{staticClass:"btn-text"},[t._v("免费抽1张")]),i("div",{staticClass:"price-number decoration"},[t._v(t._s(t.assetsInfo.single_draw_price.original_price)+"宝石")])]:t.assetsInfo.single_draw_price.half_times?[i("div",{staticClass:"btn-text"},[t._v("半价抽1张")]),i("div",{staticClass:"price-number"},[t._v(t._s(t.assetsInfo.single_draw_price.practical_price)+"宝石")])]:[i("div",{staticClass:"btn-text"},[t._v("抽1张")]),i("div",{staticClass:"price-number"},[t._v(t._s(t.assetsInfo.single_draw_price.practical_price)+"宝石")])]],2),i("div",{staticClass:"btn-tips"},[t._v(t._s(0===t.assetsInfo.single_draw_price.free_times?t.countDownText+"之后可免费再抽1张":""))])]),i("div",{staticClass:"common-btn"},[i("div",{staticClass:"continuous-btn",on:{click:function(e){return t.lottery(!0)}}},[i("div",{staticClass:"btn-text"},[t._v("5连抽")]),i("div",{staticClass:"price-number"},[t._v("250宝石")])])])]),i("div",{staticClass:"divide-line"})]),i("div",{staticClass:"assets-box"},[i("div",{on:{click:t.goPreemptiveTicketPage}},[t._v("我的抢先券："+t._s(t.assetsInfo.advance_coupon_count)+"＞")]),i("div",{on:{click:t.goDiamondPage}},[t._v("宝石："+t._s(t.assetsInfo.diamond_count)+"＞")])]),t.assetsInfo.is_diamond_vip?t._e():i("div",{staticClass:"open-vip",on:{click:t.openVip}}),i("div",{staticClass:"comic-box"},[i("div",{staticClass:"comic-title"},[i("div",{staticClass:"title-text"},[t._v("漫画抢先看")]),i("div",{staticClass:"show-more",on:{click:t.showMoreComic}},[t._v("查看更多")])]),i("ul",{staticClass:"comic-list"},t._l(t.comicInfo.ticketComicList.slice(0,3),(function(e,s){return i("li",{key:s,staticClass:"comic-item",on:{click:function(i){return t.readComic(e.comic_id)}}},[i("div",{staticClass:"comic-cover"},[i("img",{attrs:{src:t.generateComicCover(e.comic_id),alt:""}})]),i("div",{staticClass:"comic-name ellipsis"},[t._v(t._s(e.comic_name))]),i("div",{staticClass:"comic-chapter ellipsis"},[t._v(t._s(e.chapter_name))])])})),0)]),i("lottery-modal",{attrs:{mappingImgTicketType:t.mappingImgTicketType,isContinueLottery:t.isContinueLottery,prizeList:t.prizeList},model:{value:t.showLotteryModal,callback:function(e){t.showLotteryModal=e},expression:"showLotteryModal"}}),i("intro-modal",{on:{input:t.hideIntroEvent},model:{value:t.showTicketIntro,callback:function(e){t.showTicketIntro=e},expression:"showTicketIntro"}})],1)},n=[],a=(i("c5f6"),i("96cf"),i("3b8d")),o=(i("8615"),i("ac6a"),i("7f7f"),i("b619")),r=(i("a7a3"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"marqueeBox",style:{height:t.rowsNum*t.lineHeight/75+"rem",overflow:"hidden"}},[i("ul",{style:t.translate},t._l(t.msgList,(function(e,s){return i("li",{key:s,style:{height:t.lineHeight/75+"rem"}},[t._v("\n      "+t._s(e))])})),0)])}),c=[],u=i("75fc"),p={props:{dataList:{type:Array,required:!0},lineHeight:{default:40},interval:{default:2e3},rowsNum:{default:1}},data:function(){return{msgList:[],top:0,translate:""}},watch:{dataList:function(){var t=this;if(!this.msgList.length&&this.dataList.length){this.msgList=Object(u["a"])(this.dataList),this.dataList.forEach((function(e,i){i<t.rowsNum&&t.msgList.push(e)}));var e=this.dataList.length;this.animate(e)}}},methods:{animate:function(t){var e=this;setTimeout((function(){e.top-=e.lineHeight,e.translate="transform: translate(0, ".concat(e.top/75,"rem); transition: transform 500ms ease 0s"),e.top<="-".concat(t*e.lineHeight)&&setTimeout((function(){e.top=0,e.translate="transform: translate(0, 0)"}),600),e.animate(t)}),this.interval)}}},l=p,m=(i("c75b"),i("2877")),d=Object(m["a"])(l,r,c,!1,null,"4b1f4c5c",null),h=d.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{value:t.value},on:{input:t.onInput}},[i("div",{staticClass:"modal-lottery-box"},[i("div",{staticClass:"modal-title"}),t.isContinueLottery?i("div",{staticClass:"modal-title-tips"},[t._v("获赠50宝石")]):t._e(),i("div",{staticClass:"modal-content"},[t._l(t.prizeList,(function(e,s){return i("div",{key:s,class:{"prize-item":!0,"in-animation":e.inBack},on:{click:function(i){return t.filpComic(e)}}},[i("transition",{attrs:{name:"filp"}},[e.showFilp?i("div",{staticClass:"prize-content"},[i("img",{staticClass:"ticket-type-img",attrs:{src:t.mappingImgTicketType[e.star].ticketImg,alt:""}}),i("img",{staticClass:"comic-cover",attrs:{src:t.generateComicCover(e.comic_id),alt:""}}),i("div",{staticClass:"front-comic-name ellipsis"},[t._v(t._s(e.comic_name))])]):t._e()]),i("div",{staticClass:"back-side"},[i("div",{staticClass:"back-comic-name ellipsis"},[t._v(t._s(e.comic_name))]),i("div",{staticClass:"ticket-type-name"},[t._v(t._s(t.mappingImgTicketType[e.star].name))]),i("div",{staticClass:"ticket-type-tips"},[t._v(t._s(t.mappingImgTicketType[e.star].tips))])]),t.isShowGuide&&t.generateGiudeIndex(s,t.prizeList.length)?i("div",{staticClass:"guide-icon"},[i("img",{attrs:{src:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/hand.png",alt:""}})]):t._e(),i("transition",{attrs:{name:"fade"}},[e.showFade?i("div",{staticClass:"star"},[i("img",{attrs:{src:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/star.png",alt:""}})]):t._e()])],1)})),i("transition",{attrs:{name:"rotate"}},[t.showRotate?i("div",{staticClass:"rotate-bg",on:{click:function(e){return t.onInput(!1)}}}):t._e()])],2),i("div",{staticClass:"prize-tips"},[i("span",[t._v("获取的抢先券可在")]),i("span",{staticClass:"mark",on:{click:t.goPreemptiveTicketPage}},[t._v("账户记录")]),i("span",[t._v("中查看")])])])])},_=[],f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"base"}},[t.value?i("div",{staticClass:"modal-box",class:[t.transitionType],on:{click:function(e){return e.stopPropagation(),t.handleClose(e)}}},[i("div",{staticClass:"overlay",on:{touchmove:function(t){t.stopPropagation(),t.preventDefault()}}}),i("div",{staticClass:"content"},[t.showCloseBtn?i("div",{staticClass:"close-btn",on:{click:t.handleClose}}):t._e(),t._t("header"),i("div",{staticClass:"info",on:{click:function(t){t.stopPropagation()},touchmove:function(t){t.stopPropagation()}}},[t._t("default")],2),i("div",{staticClass:"footer"},[t._t("footer")],2)],2)]):t._e()])},g=[],w={name:"modal",props:{value:{type:Boolean,required:!0},transitionType:{type:String,defualt:"scale"},showCloseBtn:{type:Boolean,default:!1},closeBtnText:{type:String,default:"我知道了"}},data:function(){return{}},methods:{handleClose:function(){this.$emit("input",!1)}}},C=w,k=(i("3c3d"),Object(m["a"])(C,f,g,!1,null,"47eaaa72",null)),I=k.exports,y={name:"lottery-modal",components:{modal:I},props:{value:{required:!0},isContinueLottery:{required:!0},mappingImgTicketType:{required:!0},prizeList:{required:!0}},data:function(){return{timer:null,showRotate:!1,isShowGuide:null}},watch:{value:function(){var t=this;this.value&&(this.prizeList.forEach((function(e){t.$set(e,"inBack",!1),t.$set(e,"showFade",!1),t.$set(e,"showFilp",!1)})),this.$nextTick((function(){t.prizeList.forEach((function(e){t.$set(e,"showFade",!0),t.$set(e,"showFilp",!0)})),t.showRotate=!0,t.isShowGuide=null===localStorage.getItem("isShowGuide"),t.isShowGuide&&localStorage.setItem("isShowGuide",!1),t.timer=setTimeout((function(){t.prizeList.forEach((function(e){t.$set(e,"showFade",!1)}))}),800)})))}},methods:{onInput:function(t){var e=this;t||(this.prizeList.forEach((function(t){e.$set(t,"inBack",!1),e.$set(t,"showFade",!1),e.$set(t,"showFilp",!1)})),this.showRotate=!1),this.$emit("input",t)},generateComicCover:function(t){var e="https://image.samh.xndm.tech/cartoon/standard_cover/".concat(t,".jpg-300x400.jpg");return this.$utils.isSupportWebp()&&(e+=".webp"),e},filpComic:function(t){this.isShowGuide=null===localStorage.getItem("isShowGuide"),t.inBack=!t.inBack},generateGiudeIndex:function(t,e){return 1===e||2===e?0===t:1===t},goPreemptiveTicketPage:function(){var t={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"账户记录",title:"恭喜抽中",tName:"弹框按钮点击",event_type:"按钮点击",event_name:"AppClick"};this.$report.clickBtnCustomReport(t,this.userInfo),this.$samh.goPreemptiveTicketPage()}}},b=y,x=(i("ab8b"),Object(m["a"])(b,v,_,!1,null,null,null)),T=x.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("modal",{attrs:{showCloseBtn:!0,value:t.value},on:{input:t.onInput}},[i("div",{staticClass:"intro-box"},[i("div",{staticClass:"intro-wrapper"},[i("div",{staticClass:"intro-title"},[t._v("\n        抢先券说明\n      ")]),i("div",{staticClass:"intro-content"},[i("p",{staticClass:"intro-question"},[t._v("1.什么是抢先券?")]),i("p",{staticClass:"intro-answer"},[t._v("\n          •\n          抢先券可释放指定漫画的抢先看章节(即提前更新章节)，释放后VIP用户可直接解锁章节，非VIP用户仍需付费才能解锁章节。特别声明：每张抢先券均指定漫画和星级，即用户抽取的每一张抢先券仅能释放指定漫画的某一章节，且指定的漫画具有随机性，不能人为选择。\n        ")]),i("p",{staticClass:"intro-answer"},[t._v("• 抢先券有三个星级: 1星抢先券、2星抢先券、3星抢先券。")]),i("p",{staticClass:"intro-answer"},[t._v("1星抢先券可释放对应漫画的第一个抢先看章节")]),i("p",{staticClass:"intro-answer"},[t._v("2星抢先券可释放对应漫画的前两个抢先看章节任意一话")]),i("p",{staticClass:"intro-answer"},[t._v("3星抢先券可释放对应漫画的前三个抢先看章节任意一话")]),i("p",{staticClass:"intro-question"},[t._v("2.如何获得抢先券?")]),i("p",{staticClass:"intro-answer"},[t._v("• 可在抢先券专区通过消耗宝石抽取抢先看漫画的抢先券,抢先券永久有效")]),i("p",{staticClass:"intro-answer"},[t._v("• 抽券概率：1星券概率为60%，2星券概率为30%，3星券概率为10%")]),i("p",{staticClass:"intro-answer"},[t._v("• 保底机制：每抽5次必中2星或3星抢先券，每抽20次必中3星抢先券")]),i("p",{staticClass:"intro-answer"},[t._v("• 白金会员用户每12小时可免费抽1张，非白金会员用户每24小时可免费抽1张")]),i("p",{staticClass:"intro-tips"},[t._v("注：抢先券为虚拟产品，仅支持本账号使用，不可转赠或转移，一经抽中不退还。")])])])])])},L=[],P={name:"ticketIntro",components:{modal:I},props:{value:{required:!0}},methods:{onInput:function(t){this.$emit("input",t)}}},B=P,E=(i("ed9c"),Object(m["a"])(B,$,L,!1,null,null,null)),q=E.exports,G=null,S={name:"PreemptiveTicket",components:{marqueeList:h,LotteryModal:T,introModal:q},data:function(){return{isHeaderFixed:!1,comicInfo:{activeGroupExpireTime:"",activeGroupIndex:0,comicGroups:[],swiperComicList:[],ticketComicList:[]},assetsInfo:{groupId:1,advance_coupon_count:0,diamond_count:0,is_diamond_vip:0,single_draw_price:{},multi_draw_price:{},marqueeData:[]},prizeList:[],swiperOptions:{freeModeSticky:!0,freeMode:!0,slidesPerView:"auto",on:{click:function(){G.readComic(this.clickedSlide.dataset.cid)}}},mappingImgTicketType:{1:{name:"1星抢先券",ticketImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/ticket-one.png",swiperImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/swiper-ticket-one.png",tips:"可解锁第一个抢先看章节的任意一话"},2:{name:"2星抢先券",ticketImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/ticket-two.png",swiperImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/swiper-ticket-two.png",tips:"可解锁前两个抢先看章节的任意一话"},3:{name:"3星抢先券",ticketImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/ticket-three.png",swiperImg:"https://static.samh.xndm.tech/resource/app_h5_activity/PreemptiveTicket/swiper-ticket-three.png",tips:"可解锁前三个抢先看章节的任意一话"}},isContinueLottery:!1,showLotteryModal:!1,showTicketIntro:!1,countDownTimer:null,countDownText:"",isPending:!1,swiperTimer:null,swiperInstance:null}},computed:{swiper:function(){return this.$refs.swiper&&this.$refs.swiper.$swiper},marqueeData:function(){var t=this;return this.assetsInfo.marqueeData.map((function(e){var i=e.name,s=e.comic_name;return i.length>4&&s.length>4?(i=e.name.slice(0,2)+"..."+e.name.slice(-2),s=e.comic_name.slice(0,4)+"..."):i.length>4?i=e.name.slice(0,2)+"..."+e.name.slice(-2):s.length>4&&(s=e.comic_name.slice(0,4)+"..."),"".concat(i," 抽中《").concat(s,"》").concat(t.mappingImgTicketType[e.coupon_star].name)}))}},methods:{back:function(){this.$samh.exitApp()},showIntroEvent:function(){this.$refs.preemptiveTicketBox.style.overflow="hidden",this.showTicketIntro=!0},hideIntroEvent:function(){this.$refs.preemptiveTicketBox.style.overflow="auto"},toggleComicGroup:function(t){var e=this;this.assetsInfo.groupId=this.comicInfo.comicGroups[t].group_id,this.comicInfo.activeGroupExpireTime=this.formatCmoicGroupExpireTime(this.comicInfo.comicGroups[t].valid_end_time),this.comicInfo.swiperComicList=this.formatSwiperComicList(this.comicInfo.comicGroups[t].all_advance_coupon||[]),this.$nextTick((function(){e.initSwiper()}))},formatCmoicGroupExpireTime:function(t){var e=this;if(clearInterval(this.swiperTimer),!t)return"";var i=+new Date,s=t-i;return 407088e7===t?"":new Date(i).getFullYear()!==new Date(t).getFullYear()?"券池将于".concat(this.$utils.formatTime(t,"YYYY年MM月DD日"),"结束"):s>864e5?"券池将于".concat(this.$utils.formatTime(t,"MM月DD日"),"结束"):(this.swiperTimer=setInterval((function(){s-=1e3,e.comicInfo.activeGroupExpireTime="券池将于".concat(e.$utils.toHHmmss(s),"后结束"),s<1e3&&(clearInterval(e.swiperTimer),e.getComicList())}),1e3),"券池将于".concat(this.$utils.toHHmmss(s),"后结束"))},goDiamondPage:function(){var t={source_comic_id:this.$route.query.source_comic_id,source_chapter_id:this.$route.query.source_chapter_id,source_page_type:this.$route.query.source_page_type||"draw_advance",source_page_id:this.$route.query.source_page_id};this.$samh.goDiamondPage(t)},openVip:function(){var t={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"立即开通",element_content:"付费-白金会员",tName:"小游戏按钮点击",event_type:"按钮点击",event_name:"AppClick"};this.$report.clickBtnCustomReport(t,this.userInfo);var e={source_comic_id:this.$route.query.source_comic_id,source_chapter_id:this.$route.query.source_chapter_id,source_page_type:this.$route.query.source_page_type||"draw_advance",source_page_id:this.$route.query.source_page_id};this.$samh.goVipPage("diamond",e)},goPreemptiveTicketPage:function(){this.checkVersionIsPassed()&&this.$samh.goPreemptiveTicketPage()},generateComicCover:function(t){var e="https://image.samh.xndm.tech/cartoon/standard_cover/".concat(t,".jpg-300x400.jpg");return this.$utils.isSupportWebp()&&(e+=".webp"),e},showMoreComic:function(){var t={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"查看更多",tName:"小游戏按钮点击",event_type:"按钮点击",event_name:"AppClick"};this.$report.clickBtnCustomReport(t,this.userInfo),this.$samh.openUrl(this.$utils.getUrlPrefix()+"/samh_web/activity/app_h5_activity/PreemptiveTicket/PreemptiveTicketComics")},readComic:function(t){var e=this;if(!this.isPending){this.isPending=!0,setTimeout((function(){e.isPending=!1}),1e3);var i={screen_name:"Web-抢先券专区",cid:t,tName:"漫画点击",event_type:"漫画点击",event_name:"AppClick",cidsInSectionJson:JSON.stringify({refer:"Web-抢先券专区"})};this.$report.clickBtnCustomReport(i,this.userInfo),this.$samh.goComicDetail(t)}},formatSwiperComicList:function(t){var e={};return t.length?(t.forEach((function(t){var i=e[t.comic_id];i?t.star>i.star&&(e[t.comic_id]=t):e[t.comic_id]=t})),Object.values(e)):[]},getComicList:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.newPost("/api/v1/comics/advance_coupon/comic_dashboard",{comic_id:1,platformname:this.$samh.getPlatform(),productname:"asmh",uid_str:String(this.userInfo.uid)},{channel:"H5",app_version:this.$samh.getVersion()||"3.3.13"}).then((function(t){if(t.status)e.$toast.show("获取漫画请求失败，请稍后再试~");else{var i=+new Date,s=(t.data.all_advance_coupon_groups||[]).filter((function(t){return i>=t.valid_start_time&&i<=t.valid_end_time})),n=s[0]&&s[0].all_advance_coupon||[],a=s[0]&&s[0].group_id||1,o=e.formatCmoicGroupExpireTime(s[0]&&s[0].valid_end_time);e.comicInfo={activeGroupIndex:a,comicGroups:s,activeGroupExpireTime:o,swiperComicList:e.formatSwiperComicList(n),ticketComicList:t.data.advance_chapters||[]},e.assetsInfo.groupId=e.comicInfo.activeGroupIndex,e.$nextTick((function(){e.initSwiper()}))}})).catch((function(){e.$toast.show("网络出错，请重新进入页面~")}));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getAssetsInfo:function(){var t=this;this.$http.newGet("/api/v1/comics/advance_coupon/asset_dashboard",{uid:this.userInfo.uid,uid_str:this.userInfo.uid,platform:this.$samh.getOS(),group_id:this.assetsInfo.groupId}).then((function(e){if(e.status)t.$toast.show("获取抢先券请求失败，请稍后再试~");else if(t.assetsInfo=Object.assign({},t.assetsInfo,e.data),0===t.assetsInfo.single_draw_price.free_times){var i=1e3*t.assetsInfo.single_draw_price.free_time_cd;t.countDownText=t.$utils.toHHmmss(i),clearInterval(t.countDownTimer),t.countDownTimer=setInterval((function(){i-=1e3,t.countDownText=t.$utils.toHHmmss(i),i<1e3&&(clearInterval(t.countDownTimer),t.getAssetsInfo())}),1e3)}})).catch((function(){t.$toast.show("网络出错，请重新进入页面~")}))},checkVersionIsPassed:function(){var t=this,e=this.$samh.getVersion();return!(this.$utils.compareVersion(e,"3.3.13")<0)||(this.$dialog.show({content:"抢先券功能仅限 3.3.13 以上版本使用",confirmButtonText:"立即升级",cancelButtonText:"取消"}).then((function(){var e={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"立即升级",title:"抢先券功能仅限3.3.13以上版本使用",tName:"弹框按钮点击",event_type:"按钮点击",event_name:"AppClick"};t.$report.clickBtnCustomReport(e,t.userInfo),t.$utils.downloadApp()})).catch((function(){var e={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"取消",title:"抢先券功能仅限3.3.13以上版本使用",tName:"弹框按钮点击",event_type:"按钮点击",event_name:"AppClick"};t.$report.clickBtnCustomReport(e,t.userInfo)})),!1)},lottery:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.checkVersionIsPassed()){t.next=2;break}return t.abrupt("return");case 2:if(this.isContinueLottery=e,!(e&&this.assetsInfo.diamond_count<this.assetsInfo.multi_draw_price.practical_price||!e&&0===this.assetsInfo.single_draw_price.free_times&&this.assetsInfo.diamond_count<this.assetsInfo.single_draw_price.practical_price)){t.next=6;break}return this.$dialog.show({content:"宝石余额不足，是否去充值？",confirmButtonText:"去充值",cancelButtonText:"取消"}).then((function(){var t={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"去充值",title:"宝石余额不足，是否去充值？",element_content:"付费-宝石",tName:"弹框按钮点击",event_type:"按钮点击",event_name:"AppClick"};s.$report.clickBtnCustomReport(t,s.userInfo),s.goDiamondPage()})).catch((function(){var t={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:"取消",title:"宝石余额不足，是否去充值？",element_content:"付费-宝石",tName:"弹框按钮点击",event_type:"按钮点击",event_name:"AppClick"};s.$report.clickBtnCustomReport(t,s.userInfo)})),t.abrupt("return");case 6:if(i=1,e||(this.assetsInfo.single_draw_price.free_times?i=2:this.assetsInfo.single_draw_price.half_times&&(i=3)),this.$loading.show("请稍候~"),!this.isPending){t.next=11;break}return t.abrupt("return");case 11:return this.isPending=!0,t.next=14,this.$http.newPost("/api/v1/comics/advance_coupon/draw",{penta_draw:this.isContinueLottery?1:0,cost_type:i,group_id:this.assetsInfo.groupId,source_comic_id:+this.$route.query.source_comic_id||0,source_chapter_id:+this.$route.query.source_chapter_id||0,uid:Number(this.userInfo.uid),uid_str:String(this.userInfo.uid),nickname:encodeURIComponent(this.userInfo.name),platform:this.$samh.getOS()}).then((function(t){if(t.status)s.$toast.show("抽取抢先券请求失败，请稍后再试~");else{s.prizeList=t.data.advance_coupons,s.showLotteryModal=!0,s.getAssetsInfo(),s.$samh.refreshUserInfo();var n={true1:"5连抽",false2:"免费抽1张",false3:"半价抽1张",false1:"原价抽1张"},a={screen_name:"Web-抢先券专区",screen_id:"0500030500",elementText:n[e+""+i],tName:"小游戏按钮点击",event_type:"按钮点击",event_name:"AppClick"};s.$report.clickBtnCustomReport(a,s.userInfo)}})).catch((function(){s.$toast.show("网络出错，请重新进入页面~")})).finally((function(){s.$loading._hide(),s.isPending=!1}));case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getMarqueeData:function(){var t=this;this.$http.newGet("/api/v1/comics/advance_coupon/marquee").then((function(e){e.status?t.$toast.show("获取跑马灯数据请求失败，请稍后再试~"):t.assetsInfo.marqueeData=e.data.marquee})).catch((function(){t.$toast.show("网络出错，请重新进入页面~")}))},getUserInfo:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.$samh.getUserInfo(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(i){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.userInfo=i,t.next=3,e.getComicList();case 3:e.getAssetsInfo(),e.getMarqueeData();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),scrollEvent:function(t){var e=t.target.scrollTop;this.isHeaderFixed=e>50},visibilityEvent:function(){var t=this;"visible"===document.visibilityState&&this.$samh.getUserInfo(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.userInfo=i,t.getAssetsInfo();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},initSwiper:function(){this.swiperInstance&&this.swiperInstance.destroy(),this.swiperInstance=new o["default"](".swiper-container",this.swiperOptions)}},created:function(){G=this},mounted:function(){var t=this;this.$samh.isAndroidApp()?this.$samh.setTitleBar({navHidden:1}):this.$samh.setTitleBar('{"navHidden": 1}'),this.$refs.preemptiveTicketBox.addEventListener("scroll",this.scrollEvent),document.addEventListener("visibilitychange",this.visibilityEvent),window.onload=function(){t.getUserInfo()}},beforeDestroy:function(){this.$refs.preemptiveTicketBox.removeEventListener("scroll",this.scrollEvent),document.removeEventListener("visibilitychange",this.visibilityEvent)}},D=S,R=(i("e2d1"),Object(m["a"])(D,s,n,!1,null,"5cb3789e",null));e["default"]=R.exports},"3c3d":function(t,e,i){"use strict";var s=i("0a8b"),n=i.n(s);n.a},"504c":function(t,e,i){var s=i("9e1e"),n=i("0d58"),a=i("6821"),o=i("52a7").f;t.exports=function(t){return function(e){var i,r=a(e),c=n(r),u=c.length,p=0,l=[];while(u>p)i=c[p++],s&&!o.call(r,i)||l.push(t?[i,r[i]]:r[i]);return l}}},"81ea":function(t,e,i){},8615:function(t,e,i){var s=i("5ca1"),n=i("504c")(!1);s(s.S,"Object",{values:function(t){return n(t)}})},ab8b:function(t,e,i){"use strict";var s=i("1b5f"),n=i.n(s);n.a},b367:function(t,e,i){},c75b:function(t,e,i){"use strict";var s=i("ee6e"),n=i.n(s);n.a},e2d1:function(t,e,i){"use strict";var s=i("81ea"),n=i.n(s);n.a},ed9c:function(t,e,i){"use strict";var s=i("b367"),n=i.n(s);n.a},ee6e:function(t,e,i){}}]);